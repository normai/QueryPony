<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8" /><!-- UTF-8-with-BOM -->
   <title>QueryPony → MS-SQL via TCP/IP</title>

   <link rel="stylesheet" type="text/css" href="./daftari.css"/>
   <link rel="stylesheet" type="text/css" href="./styleslocal.css"/>
</head>

<body id="id20140127o0112">

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- Feature 20110826°1122 Typearea/Logo-Overlapper by André Motzel -->
<!-- Original implementation see http://downtown.trilo.de/svn/app.apache1/trunk/htdocs/index.html -->
<!-- todo : Adjust widths and heights -->
<div id="id20110826o112202" style="position:absolute; right:20px; padding-top:20px">
               <img id="id20110826o112203" src="./img/20130705o0812.mcol-chess-horse.v0.x0200y0200.png" width="160" height="160" alt="Logo 20130705°0812" />
</div>

<p id="id20110826o112204"><!-- this image paragraph does shift the text to left instead to cover it over -->
               <img id="id20110826o112205" src="./img/20110826o111902.transparent.png" alt="Invisible box" align="right" style="height:188px; width:188px; width:expression('0px');" />
</p>

<!-- if 10% (because chapter is 80%) of the body width is less than [imagewidth] then set DIV-width to ([imagewidth] - [10% of bodywidth]) -->
<div id="id20130724o1315" class="chapterapps" style="width:expression((document.body.clientWidth * 0.8) > 800 ? '800px': '80%'); overflow:expression('hidden');"><!-- id="id20110826o112206" -->

 <!-- todo : set a backgroundcolor for debugging -->
 <!-- div style="width:0px; float:right; background-color:#ff0000; height:162px;" -->
 <div id="id20110826o112207" style="width:0px; float:right; height:162px;
                width:expression((document.body.clientWidth * 0.1) < 160 ? (160 - document.body.clientWidth * 0.1) + 'px' : '0px');">
 </div>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

 <div id="id20140127o0514" align="right">
   <span style="vertical-align:top;">Page 3 of 8</span> &nbsp;
   <a href="./connect.html" style="color:#404040;"><img src="./img/20081114o1721.left.png.gif" width="32" height="24" alt="Go to the previous page" style="border-style: none;" /></a> &nbsp;
   <a href="./index.html" style="color:#404040;"><img src="./img/20081114o172303.up.png.gif" width="24" height="24" alt="Home" style="border-style: none;" /></a> &nbsp;
   <a href="./treeview.html" style="color:#404040;"><img src="./img/20081114o1722.right.png.gif" width="32" height="24" alt="Go to the next page" style="border-style: none;" /></a>
 </div>

 <p id="id20140127o0515">
               <a href="./index.html">Start</a> &nbsp;
               <a href="./connect.html"><b>Connect</b></a> &nbsp;
               <a href="./treeview.html">Treeview</a> &nbsp;
               <a href="./query.html">Query</a> &nbsp;
               <a href="./options.html">Options</a> &nbsp;
               <a href="./settings.html">Settings</a> &nbsp;
               <a href="./about.html">About</a> &nbsp;
       <br>
               <!-- a href="./20140127o0511.mstcp.html" --><b>MS-SQL via TCP/IP</b><!-- /a --> &nbsp;
 </p>

 <p class="topTitleCrumbs" id="id20180801o0732">
               <a href="./index.html">QueryPony User Manual</a> →
               <a href="./connect.html">The Connect Form</a> →
 </p>

 <h1 id="id20140127o0521">
               Connect to MS SQL Server via TCP/IP
 </h1>

 <p id="id20140127o0522">
               To connect to the legacy <b>Microsoft SQL Server 7</b>
               and <b>Microsoft SQL Server 2000</b> from QueryPony, you may need a non-standard procedure.
               Those versions do not yet know the shared memory protocol used by
               default by today's versions, but they speak TCP/IP.
               This page shall help you to configure a connection using TCP/IP.
 </p>

 <p id="id20140127o0523">
               To force a connection to use TCP/IP, just prepend '<b>tcp:</b>'
               to the server name.
               But in order for such connection to succeed (1) the server has to
               offer the TCP/IP protocol and (2) the client machine has to allow using it.
 </p>

 <h2>
               The Session
 </h2>

 <p id="id20140127o0524">
               This chapter just documents how I made a TCP/IP connection work
               on a Windows XP station with a SQL Server Express 10.0 (not having available a true legacy SQL Server).
               The procedure
               will surely look different on your station, but
               the story might give you an idea on what is involved.
 </p>

 <p id="id20140127o0525">
               (1) &nbsp; Try to connect with the 'tcp:' prefix.
 </p>

 <p id="id20140127o0526" class="image">
               <a href="./img/20140126o184502.querypony--connect-via-tcpip.png">
                <img src="./img/20140126o184502.querypony--connect-via-tcpip.png" width="411" height="292" alt="Image 20140126°184502 Connect to MS SQL Server via TCP/IP" data-imgdims="587 ∙ 417 * 0.7 = 411 ∙ 292" />
               </a>
       <br>
               Try to connect via TCP/IP to a Microsoft SQL Server. Instead of
          <br> 'localhost' you may also write '127.0.0.1' or the name of the machine.
 </p>

 <p id="id20140127o0531">
               (2) &nbsp; QueryPony probably refuses to connect.
 </p>

 <p id="id20140127o0532" class="image">
               <a href="./img/20140126o1522.querypony--test-mssql-over-tcp--error.png">
                <img src="./img/20140126o1522.querypony--test-mssql-over-tcp--error.png" width="624" height="76" alt="Image 20140126°1522 Error message" data-imgdims="1041 ∙ 126 * 0.6 = 624 ∙ 76" />
               </a>
       <br>
               Trying to connect via TCP/IP may result in this error message.
 </p>

 <p id="id20140127o0533">
               (3) &nbsp; On the machine with the SQL Server, go to the Control Panel
               and inspect the protocols your SQL Server is offering.
 </p>

 <p id="id20140127o0534" class="image">
               <a href="./img/20140126o1821.comp-man--sqlexpress--protocols.png">
                <img src="./img/20140126o1821.comp-man--sqlexpress--protocols.png" width="461" height="317" alt="Image 20140126°1821" data-imgdims="658 ∙ 452 * 0.7 = 461 ∙ 317" />
               </a>
       <br>
               The TCP/IP protocol is disabled by default. Rightclick and <b>enable it</b>!
 </p>

 <p id="id20140127o0535">
               (4) &nbsp; Windows tells you to restart the SQL Server.
 </p>

 <p id="id20140127o0536" class="image">
               <a href="./img/20140126o1822.comp-man--sqlexpress--restart.png">
                <img src="./img/20140126o1822.comp-man--sqlexpress--restart.png" width="424" height="89" alt="Image 20140126°1822" />
               </a>
       <br>
               Restart the SQL Server or the simply reboot.
         <br>  (Or wait because below comes another restart.)
 </p>

 <p id="id20140127o0541">
               (5) &nbsp; Though set being enabled, the TCP/IP protocol seems not yet available.
               So have a closer look on the properties.
 </p>

 <p id="id20140127o0542" class="image">
               <a href="./img/20140126o1824.comp-man-sqlexpress--protocols--tcp-enabled.png">
                <img src="./img/20140126o1824.comp-man-sqlexpress--protocols--tcp-enabled.png" width="425" height="320" alt="Image 20140126°1824" />
               </a>
       <br>
               Have a closer look to the protocol settings by rightclick/Properties.
 </p>

 <p id="id20140127o0543">
               (6) &nbsp; The Protocol Properties dialog shows a second place where the TCP/IP protocol
                must be enabled (per network card).
 </p>

 <p id="id20140127o0544" class="image">
               <a href="./img/20140126o1825.comp-man-sqlexpress--protocols--tcp--props.png">
                <img src="./img/20140126o1825.comp-man-sqlexpress--protocols--tcp--props.png" width="277" height="309" alt="Image 20140126°1825" />
               </a>
       <br>
               Set the protocol to '<b>Enabled = Yes</b>' on the Protocol Properties dialog as well.
         <br>  Again the SQL Server needs to be restarted (could have skipped the restart above).
 </p>

 <p id="id20140127o0545">
               (7) &nbsp; Not only the server has to be ready to talk TCP/IP, but also
               the client machine has to allow for it. Again go to the Control Panel, this
               time for the Windows Services. (Of course, if the SQL Server is on 'localhost',
               the server machine and the client machine are the same.)
 </p>

 <p id="id20140127o0546" class="image">
               <a href=".img/20140126o1841.control-panel--services--sql-server-browser.png">
                <img src="./img/%2320140126'1841.control-panel--services--sql-server-browser.png" width="623" height="347" alt="Image 20140126°1841" />
               </a>
       <br>
               If you see the SQL Server Browser disabled, then <b>start it</b>!
 </p>

 <p id="id20140127o0547">
               (8) &nbsp; Back in QueryPony, I try again to make a SQL Server connection
               via TCP/IP and -- it works!
 </p>

 <p id="id20140127o0548" class="image">
               <a href="img/20140126o1845.querypony--connect-via-tcpip--heureka.png">
                <img src="./img/20140126o1845.querypony--connect-via-tcpip--heureka.png" width="506" height="356" alt="Image 20140126°184502 Connect to MS SQL Server via TCP/IP succeeded" data-imgdims="844 ∙ 592 * 0.6 = 506 ∙ 356" />
               </a>
       <br>
               Connection via TCP/IP to a Microsoft SQL Server succeeded.
 </p>

 <p id="id20140127o0549">
               &nbsp;
 </p>

 <h2>
               Attention
 </h2>

 <p id="id20140127o0551">
               Above description does not tell anything about
               the <b>security issues</b> you raise when you open the TCP/IP
               protocol for the SQL Server. Escpecially on a productive
               system, you have to know what you are doing. Perhaps it is
               not allowed at all in your environment, or at least you may
               want to adjust the firewall(s) accordingly.
 </p>

 <p id="id20140127o0552">
               Note: The procedure described above is not yet confirmed or finetuned
               by other people. I wish you good luck. Please feedback any mistakes.
 </p>

 <h2>
               Links
 </h2>

 <p id="id20140127o0553">
               Blog article
               <a href="http://sqlserverbuilds.blogspot.de" target="_blank">
                Microsoft SQL Server 2014, 2012, 2008R2, 2008, 2005, 2000 and 7.0 Builds
               </a> .
               provides a nice summary about the existing SQL Server versions.
               <span class="timestamp">(#&nbsp;20140126.1111)</span>
 </p>

 <p id="id20140127o0554">
               On the MSDN page
               <a href="http://msdn.microsoft.com/library/system.data.sqlclient%28v=vs.90%29.aspx" target="_blank">
                System.Data.SqlClient Namespace
               </a>
               the crucial statement about accessing SQL Server 7 and SQL Server 2000 is found:
               <span class="fontTty">Caution ADO.NET 2.0 does not support asynchronous commands over
               shared memory for SQL Server 2000 or lower. However, you can force
               TCP instead of shared memory. You can do that by prefixing tcp: to
               the server name in the connection string or you can use localhost.</span>
               <span class="timestamp">(#&nbsp;20140126.1512)</span>
 </p>

 <p id="id20140127o0555">
               The Microsoft support page
               <a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;914277" target="_blank">
                How to configure SQL Server 2005 to allow remote connections
               </a>
               describes the TCP/IP configuration for a remote connection to the SQL Server(s).
               <span class="timestamp">(#&nbsp;20140126.1833)</span>
 </p>

 <p id="id20140127o0556">
               The blog article
               <a href="http://www.linglom.com/it-support/enable-remote-connection-on-sql-server-2008-express" target="_blank">
                Enable Remote Connection on SQL Server 2008 Express
               </a>
               describes how to configure a remote connection to SQL Server 2008.
               <span class="timestamp">(#&nbsp;20140126.1832)</span>
 </p>

</div>

<p class="footerUpdate" id="id20140127o0113">
               Version : 2014-Jan-27
</p>
<p class="footerImprint" id="id20130724o1318">
               Imprint : <a href="http://www.trilo.de/imprint.html" class="extern">www.trilo.de/imprint.html</a>
</p>
<p class="footerReferer" id="id20140127o0511">
               <span class="footerFileUrl">http://downtown.trilo.de/svn/queryponydev/trunk/querypony/QueryPonyGui/docs/<a href="http://downtown.trilo.de/svn/queryponydev/trunk/querypony/QueryPonyGui/docs/20140127o0511.mstcp.html">20140127o0511.mstcp.html</a></span>
               <span class="footerCopyright">© 2013 - 2018 Norbert C. Maier</span>
               <span class="footerPageId">20140127°0111</span>
</p>
</body>
</html>
